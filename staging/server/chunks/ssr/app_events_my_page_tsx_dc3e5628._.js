module.exports=[7056,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(38246),f=a.i(47033),g=a.i(36099),h=a.i(69337),i=a.i(60999),j=a.i(3130),k=a.i(40695),l=a.i(5522),m=a.i(16474),n=a.i(87682),o=a.i(17199);let p="https://APimenta4.pythonanywhere.com/api",q={SOCIAL:"bg-blue-500 text-white",ACADEMIC:"bg-green-500 text-white",TRAVEL:"bg-yellow-500 text-black",SPORTS:"bg-red-500 text-white",CULTURAL:"bg-purple-500 text-white",VOLUNTEERING:"bg-teal-500 text-white",NIGHTLIFE:"bg-pink-500 text-white"};function r(){let a=(0,d.useRouter)(),[r,s]=(0,c.useState)(!1),[t,u]=(0,c.useState)(!1),[v,w]=(0,c.useState)(null),[x,y]=(0,c.useState)([]),[z,A]=(0,c.useState)(new Set),[B,C]=(0,c.useState)({}),[D,E]=(0,c.useState)([]),[F,G]=(0,c.useState)(!0),[H,I]=(0,c.useState)(null),[J,K]=(0,c.useState)(!1),[L,M]=(0,c.useState)(null),[N,O]=(0,c.useState)(!1),[P,Q]=(0,c.useState)(""),[R,S]=(0,c.useState)({name:"",date:"",location:"",description:"",capacity:"",category:""}),[T,U]=(0,c.useState)({}),[V,W]=(0,c.useState)(""),[X,Y]=(0,c.useState)(!1);if((0,c.useEffect)(()=>{s(!0);let b=(0,f.isAuthenticated)();(u(b),b)?(async()=>{try{G(!0),I(null);let a=await (0,g.getProfile)();w(a.role);let b=a.participating_events||[];if("ORGANIZER"===a.role)try{let a=await (0,i.getMyOrganizations)(),b=[...a.owned||[],...a.collaborated||[]];y(b);let c=new Set((a.owned||[]).map(a=>a.id));A(c),1===b.length&&Q(String(b[0].id));let d=await (0,h.getMyOrganizedEvents)(),e={};d.forEach(a=>{let b=a.organization_name||"Unknown Organization";e[b]||(e[b]=[]),e[b].push(a)}),C(e)}catch(a){console.error("Failed to load organized events or organizations:",a)}if(0===b.length){E([]),G(!1);return}let c=b.map(async a=>{try{let b=await (0,f.fetchWithAuth)(`${p}/events/${a}/`,{method:"GET"});if(!b.ok)return console.error(`Failed to fetch event ${a}`),null;return b.json()}catch(b){return console.error(`Error fetching event ${a}:`,b),null}}),d=(await Promise.all(c)).filter(a=>null!==a).sort((a,b)=>new Date(a.date).getTime()-new Date(b.date).getTime());E(d)}catch(a){console.error("Failed to load events:",a),I(a instanceof Error?a.message:"Failed to load your events")}finally{G(!1)}})():a.replace("/profile/login")},[a]),!r||!t||F)return(0,b.jsx)("div",{className:"container mx-auto p-8 max-w-7xl",children:(0,b.jsx)(j.Card,{children:(0,b.jsx)(j.CardContent,{className:"py-12 text-center",children:(0,b.jsx)("p",{className:"text-muted-foreground",children:"Loading your events..."})})})});if(H)return(0,b.jsx)("div",{className:"container mx-auto p-8 max-w-7xl",children:(0,b.jsxs)(j.Card,{children:[(0,b.jsxs)(j.CardHeader,{children:[(0,b.jsx)(j.CardTitle,{children:"Error"}),(0,b.jsx)(j.CardDescription,{children:H})]}),(0,b.jsx)(j.CardFooter,{children:(0,b.jsx)(k.Button,{variant:"outline",onClick:()=>a.push("/"),children:"Back to Home"})})]})});let Z=a=>(0,b.jsxs)(j.Card,{className:"hover:shadow-lg transition-shadow relative flex flex-col",children:[(0,b.jsxs)("div",{className:"absolute top-2 right-2 flex items-center gap-2 z-10",children:[(0,b.jsx)("span",{className:`px-2 py-1 text-xs font-semibold rounded-md ${q[a.category]||"bg-gray-500 text-white"}`,children:a.category}),a.status&&(0,b.jsx)("span",{className:`text-white text-xs px-2 py-1 rounded-md font-semibold ${"Active"===a.status?"bg-green-500":"Cancelled"===a.status||"Canceled"===a.status?"bg-red-500":"bg-gray-500"}`,children:a.status})]}),(0,b.jsxs)(j.CardHeader,{children:[(0,b.jsx)(j.CardTitle,{children:a.name}),(0,b.jsx)(j.CardDescription,{children:new Date(a.date).toLocaleString()})]}),(0,b.jsxs)(j.CardContent,{className:"flex-1",children:[a.location?(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["ðŸ“ ",a.location]}):(0,b.jsx)("p",{className:"text-sm text-muted-foreground opacity-0",children:"Â "}),(a.created_by||a.organizer_name)&&(0,b.jsxs)("p",{className:"text-sm text-muted-foreground mt-2",children:["Created by ",a.created_by||a.organizer_name]}),(0,b.jsxs)("div",{className:"flex items-center gap-3 mt-2 text-xs text-muted-foreground",children:[void 0!==a.participant_count&&(0,b.jsxs)("span",{children:["ðŸ‘¥ ",a.participant_count," participants"]}),void 0!==a.interest_count&&(0,b.jsxs)("span",{children:["â¤ï¸ ",a.interest_count," interested"]})]})]}),(0,b.jsx)(j.CardFooter,{children:(0,b.jsx)(k.Button,{variant:"outline",className:"w-full",onClick:()=>{M(String(a.id)),K(!0)},children:"View Details"})})]},a.id),$=async()=>{if(t)try{let a=await (0,g.getProfile)(),b=a.participating_events||[];if("ORGANIZER"===a.role)try{let a=await (0,i.getMyOrganizations)(),b=[...a.owned||[],...a.collaborated||[]];y(b);let c=new Set((a.owned||[]).map(a=>a.id));A(c);let d=await (0,h.getMyOrganizedEvents)(),e={};d.forEach(a=>{let b=a.organization_name||"Unknown Organization";e[b]||(e[b]=[]),e[b].push(a)}),C(e)}catch(a){console.error("Failed to refresh organized events or organizations:",a)}if(0===b.length)return void E([]);let c=b.map(async a=>{try{let b=await (0,f.fetchWithAuth)(`${p}/events/${a}/`,{method:"GET"});if(!b.ok)return null;return b.json()}catch{return null}}),d=(await Promise.all(c)).filter(a=>null!==a).sort((a,b)=>new Date(a.date).getTime()-new Date(b.date).getTime());E(d)}catch(a){console.error("Failed to refresh events:",a)}},_=async a=>{let b,c;if(a.preventDefault(),b={},c=!1,(P||(b.organization="Organization is required",c=!0),Object.entries(R).forEach(([a,d])=>{"capacity"!==a&&("string"!=typeof d||d.trim()||(b[a]=`${a.charAt(0).toUpperCase()+a.slice(1)} is required`,c=!0))}),R.capacity&&0>Number(R.capacity)&&(b.capacity="Capacity cannot be negative",c=!0),U(b),c)?(W("Please fill in all required fields"),!1):(W(""),!0))try{Y(!0);let a={...R,capacity:""===R.capacity?0:Number(R.capacity),organization:Number(P)};if(!(await (0,f.fetchWithAuth)(`${p}/events/create/`,{method:"POST",body:JSON.stringify(a)})).ok)throw Error("Failed to create event");S({name:"",date:"",location:"",description:"",capacity:"",category:""}),U({}),W(""),O(!1),await $()}catch(a){W("Failed to create event"),console.error("Error creating event:",a)}finally{Y(!1)}},aa=Object.values(B).reduce((a,b)=>a+b.length,0),ab=D.length>0,ac=x.length>0;return(0,b.jsxs)("div",{className:"container mx-auto p-8 max-w-7xl",children:[(0,b.jsx)("div",{className:"mb-6",children:(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"My Events"})}),"ORGANIZER"===v&&(0,b.jsxs)("div",{className:"mb-12",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsx)("h2",{className:"text-2xl font-semibold",children:"Events I'm Organizing"}),ac&&(0,b.jsx)(k.Button,{variant:N?"outline":"default",onClick:()=>O(!N),children:N?"Cancel":"Create Event"})]}),N&&ac&&(0,b.jsx)(j.Card,{className:"mb-6",children:(0,b.jsx)(j.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"text-left max-w-2xl mx-auto",children:[(0,b.jsx)("h3",{className:"text-xl font-semibold mb-4",children:"Create New Event"}),(0,b.jsxs)("form",{onSubmit:_,children:[(0,b.jsxs)(m.Field,{className:"mb-4",children:[(0,b.jsxs)(m.FieldLabel,{children:["Organization ",(0,b.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,b.jsxs)(m.FieldContent,{children:[(0,b.jsxs)(n.Select,{value:P,onValueChange:a=>{Q(a),U({...T,organization:""}),W("")},children:[(0,b.jsx)(n.SelectTrigger,{children:(0,b.jsx)(n.SelectValue,{placeholder:"Select organization"})}),(0,b.jsx)(n.SelectContent,{children:x.map(a=>(0,b.jsx)(n.SelectItem,{value:String(a.id),children:a.name},a.id))})]}),T.organization&&(0,b.jsx)(m.FieldError,{children:T.organization})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[(0,b.jsxs)(m.Field,{children:[(0,b.jsxs)(m.FieldLabel,{children:["Name ",(0,b.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,b.jsx)(m.FieldContent,{children:(0,b.jsx)(l.Input,{type:"text",value:R.name,onChange:a=>{S({...R,name:a.target.value}),U({...T,name:""}),W("")}})}),T.name&&(0,b.jsx)(m.FieldError,{children:T.name})]}),(0,b.jsxs)(m.Field,{children:[(0,b.jsxs)(m.FieldLabel,{children:["Date and Time"," ",(0,b.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,b.jsx)(m.FieldContent,{children:(0,b.jsx)(l.Input,{type:"datetime-local",value:R.date,onChange:a=>{S({...R,date:a.target.value}),U({...T,date:""}),W("")}})}),T.date&&(0,b.jsx)(m.FieldError,{children:T.date})]}),(0,b.jsxs)(m.Field,{children:[(0,b.jsxs)(m.FieldLabel,{children:["Location ",(0,b.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,b.jsx)(m.FieldContent,{children:(0,b.jsx)(l.Input,{type:"text",value:R.location,onChange:a=>{S({...R,location:a.target.value}),U({...T,location:""}),W("")}})}),T.location&&(0,b.jsx)(m.FieldError,{children:T.location})]}),(0,b.jsxs)(m.Field,{children:[(0,b.jsxs)(m.FieldLabel,{children:["Category ",(0,b.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,b.jsx)(m.FieldContent,{children:(0,b.jsxs)(n.Select,{value:R.category,onValueChange:a=>{S({...R,category:a}),U({...T,category:""}),W("")},children:[(0,b.jsx)(n.SelectTrigger,{children:(0,b.jsx)(n.SelectValue,{placeholder:"Select a category"})}),(0,b.jsxs)(n.SelectContent,{children:[(0,b.jsx)(n.SelectItem,{value:"SOCIAL",children:"Social"}),(0,b.jsx)(n.SelectItem,{value:"ACADEMIC",children:"Academic"}),(0,b.jsx)(n.SelectItem,{value:"TRAVEL",children:"Travel"}),(0,b.jsx)(n.SelectItem,{value:"SPORTS",children:"Sports"}),(0,b.jsx)(n.SelectItem,{value:"CULTURAL",children:"Cultural"}),(0,b.jsx)(n.SelectItem,{value:"VOLUNTEERING",children:"Volunteering"}),(0,b.jsx)(n.SelectItem,{value:"NIGHTLIFE",children:"Nightlife"})]})]})}),T.category&&(0,b.jsx)(m.FieldError,{children:T.category})]}),(0,b.jsxs)(m.Field,{children:[(0,b.jsx)(m.FieldLabel,{children:"Maximum Capacity"}),(0,b.jsx)(m.FieldContent,{children:(0,b.jsx)(l.Input,{type:"number",placeholder:"Unlimited if blank",value:R.capacity,onChange:a=>{S({...R,capacity:a.target.value}),U({...T,capacity:""}),W("")}})}),T.capacity&&(0,b.jsx)(m.FieldError,{children:T.capacity})]}),(0,b.jsxs)(m.Field,{className:"md:col-span-2",children:[(0,b.jsxs)(m.FieldLabel,{children:["Description"," ",(0,b.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,b.jsx)(m.FieldContent,{children:(0,b.jsx)("textarea",{className:"w-full p-2 border rounded min-h-[100px]",value:R.description,onChange:a=>{S({...R,description:a.target.value}),U({...T,description:""}),W("")}})}),T.description&&(0,b.jsx)(m.FieldError,{children:T.description})]})]}),(0,b.jsxs)("div",{className:"flex gap-4 mt-6",children:[(0,b.jsx)(k.Button,{type:"submit",disabled:X,children:X?"Creating...":"Create Event"}),(0,b.jsx)(k.Button,{type:"button",variant:"outline",onClick:()=>{O(!1),S({name:"",date:"",location:"",description:"",capacity:"",category:""}),U({}),W("")},children:"Cancel"})]}),V&&(0,b.jsx)(m.FieldError,{className:"mt-4",children:V})]})]})})}),aa>0?(0,b.jsx)(b.Fragment,{children:Object.entries(B).sort(([a],[b])=>a.localeCompare(b)).map(([a,c])=>{let d=c[0]?.organization_id,f=!!d&&z.has(d),g=!!d&&!f&&x.some(a=>a.id===d);return(0,b.jsxs)("div",{className:"mb-8",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,b.jsx)("h3",{className:"text-xl font-medium text-muted-foreground",children:d?(0,b.jsx)(e.default,{href:`/organizations/detail?id=${d}`,className:"hover:text-foreground hover:underline transition-colors",onClick:()=>{sessionStorage.setItem("org_detail_referrer","/events/my")},children:a}):a}),f&&(0,b.jsx)("span",{className:"px-2 py-1 text-xs font-semibold text-white bg-blue-600 rounded-md",children:"Owner"}),g&&(0,b.jsx)("span",{className:"px-2 py-1 text-xs font-semibold text-white bg-gray-600 rounded-md",children:"Collaborator"})]}),(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:c.map(a=>Z(a))})]},a)})}):ac?(0,b.jsx)(j.Card,{children:(0,b.jsx)(j.CardContent,{className:"py-12 text-center",children:(0,b.jsx)("p",{className:"text-muted-foreground mb-4",children:"You haven't organized any events yet."})})}):(0,b.jsx)(j.Card,{children:(0,b.jsxs)(j.CardContent,{className:"py-12 text-center",children:[(0,b.jsx)("p",{className:"text-muted-foreground mb-4",children:"You are currently not part of any organization. You need to create or be invited to an organization before you can organize events."}),(0,b.jsx)(k.Button,{variant:"outline",onClick:()=>a.push("/organizations/create"),children:"Create Organization"})]})})]}),(0,b.jsxs)("div",{className:"",children:[(0,b.jsx)("h2",{className:"text-2xl font-semibold mb-4",children:"Events I'm Participating In"}),ab?(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:D.map(a=>Z(a))}):(0,b.jsx)(j.Card,{children:(0,b.jsxs)(j.CardContent,{className:"py-12 text-center",children:[(0,b.jsx)("p",{className:"text-muted-foreground mb-4",children:"You have not registered for any events yet."}),(0,b.jsx)(k.Button,{variant:"outline",onClick:()=>a.push("/events"),children:"Browse Events"})]})})]}),J&&L&&(0,b.jsx)(o.default,{id:L,onClose:()=>{K(!1),M(null),$()}})]})}a.s(["default",()=>r])}];

//# sourceMappingURL=app_events_my_page_tsx_dc3e5628._.js.map