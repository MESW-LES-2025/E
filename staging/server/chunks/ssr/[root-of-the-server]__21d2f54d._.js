module.exports=[9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},36313,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HooksClientContext},18341,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ServerInsertedHtml},18622,(a,b,c)=>{b.exports=a.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},42602,(a,b,c)=>{"use strict";b.exports=a.r(18622)},87924,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactJsxRuntime},72131,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].React},38783,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactServerDOMTurbopackClient},36099,a=>{"use strict";var b=a.i(47033);let c="https://APimenta4.pythonanywhere.com/api";async function d(){let a=await (0,b.fetchWithAuth)(`${c}/accounts/profile/me/`,{method:"GET"});if(!a.ok){let b=await a.json().catch(()=>({})),c=b?.detail||"Failed to fetch profile";if(401===a.status||403===a.status)throw Error("Session expired. Please log in again.");throw Error(c)}return a.json()}async function e(a){let d=await (0,b.fetchWithAuth)(`${c}/accounts/profile/me/`,{method:"PATCH",body:JSON.stringify(a)});if(!d.ok){let a=await d.json().catch(()=>({}));throw Error(a?.detail||"Failed to update profile")}return d.json()}a.s(["getProfile",()=>d,"updateProfile",()=>e])},49118,a=>{"use strict";var b=a.i(47033);let c="https://APimenta4.pythonanywhere.com/api";async function d(){let a=await (0,b.fetchWithAuth)(`${c}/notifications/unread-count/`,{method:"GET"});if(!a.ok)throw Error("Failed to fetch unread count");return(await a.json()).unread??0}async function e(){let a=await (0,b.fetchWithAuth)(`${c}/notifications/`,{method:"GET"});if(!a.ok)throw Error("Failed to fetch notifications");let d=await a.json();return Array.isArray(d)?d:d.results??[]}async function f(a){if(!(await (0,b.fetchWithAuth)(`${c}/notifications/${a}/mark-as-read/`,{method:"POST"})).ok)throw Error("Failed to mark as read")}async function g(a){if(!(await (0,b.fetchWithAuth)(`${c}/notifications/${a}/mark-as-unread/`,{method:"POST"})).ok)throw Error("Failed to mark as unread")}async function h(){let a=await (0,b.fetchWithAuth)(`${c}/notifications/mark-all-as-read/`,{method:"POST"});if(!a.ok)throw Error("Failed to mark all as read");return(await a.json()).updated??0}a.s(["getUnreadCount",()=>d,"listNotifications",()=>e,"markAllAsRead",()=>h,"markAsRead",()=>f,"markAsUnread",()=>g])},72850,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(38246),f=a.i(47033),g=a.i(36099),h=a.i(40695),i=a.i(49118);function j(){let a=(0,d.useRouter)(),j=(0,d.usePathname)(),[k,l]=(0,c.useState)(!1),[m,n]=(0,c.useState)(null),[o,p]=(0,c.useState)(!0),[q,r]=(0,c.useState)(0);(0,c.useEffect)(()=>{(async()=>{let b=(0,f.isAuthenticated)();if(l(b),b){try{let a=await (0,g.getProfile)();n(a)}catch(c){console.error("Failed to load profile:",c);let b=c instanceof Error?c.message:"";b.includes("token")||b.includes("not valid")||b.includes("authentication")||b.includes("Session expired")?((0,f.logout)(),l(!1),n(null),"/profile/login"!==j&&a.push("/profile/login")):l(!1)}try{let a=await (0,i.getUnreadCount)();r(a)}catch{r(0)}}else n(null),r(0);p(!1)})()},[j,a]);let s=m?.role==="ORGANIZER";return(0,b.jsxs)("header",{className:"bg-white shadow p-4 flex justify-between items-center",children:[(0,b.jsx)(e.default,{href:"/",children:(0,b.jsx)("h1",{className:"text-2xl font-bold cursor-pointer",children:"Erasmus in Porto"})}),(0,b.jsxs)("nav",{className:"flex gap-4",children:[(0,b.jsx)(e.default,{href:"/",children:(0,b.jsx)(h.Button,{variant:"ghost",children:"Home"})}),o?(0,b.jsx)(h.Button,{variant:"ghost",disabled:!0,children:"Loading..."}):k?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(e.default,{href:"/calendar",children:(0,b.jsx)(h.Button,{variant:"ghost",children:"Calendar"})}),s&&(0,b.jsx)(e.default,{href:"/organizations/my",children:(0,b.jsx)(h.Button,{variant:"ghost",children:"My Organizations"})}),(0,b.jsx)(e.default,{href:"/events/my",children:(0,b.jsx)(h.Button,{variant:"ghost",children:"My Events"})}),(0,b.jsx)(e.default,{href:"/profile",children:(0,b.jsx)(h.Button,{variant:"ghost",children:"My Profile"})}),(0,b.jsx)(e.default,{href:"/notifications",className:"relative",children:(0,b.jsxs)(h.Button,{variant:"ghost",className:"relative",children:[(0,b.jsx)("span",{className:"mr-2",children:"ðŸ””"}),"Notifications",q>0&&(0,b.jsx)("span",{className:"absolute -top-2 -right-2 bg-red-600 text-white text-xs rounded-full px-2 py-0.5",children:q})]})}),(0,b.jsx)(h.Button,{variant:"ghost",onClick:()=>{(0,f.logout)(),l(!1),n(null),r(0),a.push("/profile/login")},children:"Logout"})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(e.default,{href:"/calendar",children:(0,b.jsx)(h.Button,{variant:"ghost",children:"Calendar"})}),(0,b.jsx)(e.default,{href:"/profile/register",children:(0,b.jsx)(h.Button,{variant:"ghost",children:"Register"})}),(0,b.jsx)(e.default,{href:"/profile/login",children:(0,b.jsx)(h.Button,{variant:"ghost",children:"Sign In"})})]})]})]})}a.s(["default",()=>j])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__21d2f54d._.js.map