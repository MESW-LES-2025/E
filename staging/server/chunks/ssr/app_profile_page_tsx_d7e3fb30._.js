module.exports=[65066,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(38246),f=a.i(47033),g=a.i(36099),h=a.i(60999),i=a.i(69337),j=a.i(40695),k=a.i(5522),l=a.i(3130),m=a.i(16474);function n(){var a;let n=(0,d.useRouter)(),[o,p]=(0,c.useState)(!1),[q,r]=(0,c.useState)(!1),[s,t]=(0,c.useState)(null),[u,v]=(0,c.useState)(!0),[w,x]=(0,c.useState)(null),[y,z]=(0,c.useState)(!1),[A,B]=(0,c.useState)(!1),[C,D]=(0,c.useState)(null),[E,F]=(0,c.useState)("profile"),[G,H]=(0,c.useState)(""),[I,J]=(0,c.useState)(""),[K,L]=(0,c.useState)([]),[M,N]=(0,c.useState)(!1),[O,P]=(0,c.useState)(null),[Q,R]=(0,c.useState)(new Set),[S,T]=(0,c.useState)([]),[U,V]=(0,c.useState)(!1),[W,X]=(0,c.useState)(null),[Y,Z]=(0,c.useState)(new Set);(0,c.useEffect)(()=>{p(!0);let a=(0,f.isAuthenticated)();(r(a),a)?(async()=>{try{v(!0),x(null);let a=await (0,g.getProfile)();if(!a){t(null),H(""),J("");return}t(a),H(a.phone_number||""),J(a.bio||"")}catch(a){x(a instanceof Error?a.message:"Failed to load profile")}finally{v(!1)}})():n.replace("/profile/login")},[n]),(0,c.useEffect)(()=>{"followed"===E&&q&&(async()=>{try{N(!0),P(null);let a=await (0,h.getFollowedOrganizations)();L(a)}catch(a){P(a instanceof Error?a.message:"Failed to load followed organizations")}finally{N(!1)}})()},[E,q]),(0,c.useEffect)(()=>{"interested"===E&&q&&s?.role==="ATTENDEE"&&(async()=>{try{V(!0),X(null);let a=await (0,i.getInterestedEvents)();T(a)}catch(a){X(a instanceof Error?a.message:"Failed to load interested events")}finally{V(!1)}})()},[E,q,s?.role]);let $=async a=>{try{R(b=>new Set(b).add(a)),await (0,h.unfollowOrganization)(a),L(b=>b.filter(b=>b.id!==a))}catch(a){console.error("Failed to unfollow organization:",a),alert(a instanceof Error?a.message:"Failed to unfollow organization. Please try again.")}finally{R(b=>{let c=new Set(b);return c.delete(a),c})}},_=async a=>{try{Z(b=>new Set(b).add(a)),await (0,i.unmarkEventAsInterested)(a),T(b=>b.filter(b=>b.id!==a))}catch(a){console.error("Failed to remove interest:",a),alert(a instanceof Error?a.message:"Failed to remove interest. Please try again.")}finally{Z(b=>{let c=new Set(b);return c.delete(a),c})}};if(!o)return(0,b.jsx)("div",{className:"container mx-auto p-8 max-w-4xl",children:(0,b.jsx)("p",{children:"Loading..."})});let aa=async()=>{try{B(!0),D(null);let a=await (0,g.updateProfile)({phone_number:G,bio:I});t(a),z(!1)}catch(a){D(a instanceof Error?a.message:"Failed to update profile")}finally{B(!1)}};return q?u?(0,b.jsx)("div",{className:"p-6",children:(0,b.jsx)("p",{children:"Loading profile..."})}):w?(0,b.jsx)("div",{className:"p-6",children:(0,b.jsxs)(l.Card,{children:[(0,b.jsxs)(l.CardHeader,{children:[(0,b.jsx)(l.CardTitle,{children:"Error"}),(0,b.jsx)(l.CardDescription,{children:w})]}),(0,b.jsx)(l.CardFooter,{children:(0,b.jsx)(j.Button,{onClick:()=>n.refresh(),children:"Retry"})})]})}):s?(0,b.jsxs)("div",{className:"container mx-auto p-8 max-w-4xl",children:[(0,b.jsx)("div",{className:"mb-6",children:(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"My Profile"})}),"ATTENDEE"===s.role&&(0,b.jsx)("div",{className:"mb-6 border-b border-gray-200",children:(0,b.jsxs)("nav",{className:"flex gap-4",children:[(0,b.jsx)("button",{onClick:()=>F("profile"),className:`pb-3 px-1 border-b-2 font-medium transition-colors ${"profile"===E?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Profile Information"}),(0,b.jsx)("button",{onClick:()=>F("followed"),className:`pb-3 px-1 border-b-2 font-medium transition-colors ${"followed"===E?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Followed Organizations"}),(0,b.jsx)("button",{onClick:()=>F("interested"),className:`pb-3 px-1 border-b-2 font-medium transition-colors ${"interested"===E?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Interested Events"})]})}),"profile"===E&&(0,b.jsxs)(l.Card,{children:[(0,b.jsxs)(l.CardHeader,{children:[(0,b.jsx)(l.CardTitle,{children:"Profile Information"}),(0,b.jsx)(l.CardDescription,{children:"View and manage your profile information"})]}),(0,b.jsx)(l.CardContent,{children:(0,b.jsxs)(m.FieldGroup,{children:[(0,b.jsxs)(m.Field,{children:[(0,b.jsx)(m.FieldLabel,{children:"Username"}),(0,b.jsx)(m.FieldContent,{children:(0,b.jsx)(k.Input,{value:s.username,disabled:!0})})]}),(0,b.jsxs)(m.Field,{children:[(0,b.jsx)(m.FieldLabel,{children:"Email"}),(0,b.jsx)(m.FieldContent,{children:(0,b.jsx)(k.Input,{value:s.email,disabled:!0})})]}),(0,b.jsxs)(m.Field,{children:[(0,b.jsx)(m.FieldLabel,{children:"First Name"}),(0,b.jsx)(m.FieldContent,{children:(0,b.jsx)(k.Input,{value:s.first_name,disabled:!0})})]}),(0,b.jsxs)(m.Field,{children:[(0,b.jsx)(m.FieldLabel,{children:"Last Name"}),(0,b.jsx)(m.FieldContent,{children:(0,b.jsx)(k.Input,{value:s.last_name,disabled:!0})})]}),(0,b.jsxs)(m.Field,{children:[(0,b.jsx)(m.FieldLabel,{children:"Role"}),(0,b.jsx)(m.FieldContent,{children:(0,b.jsx)(k.Input,{value:{ATTENDEE:"Attendee",ORGANIZER:"Organizer",ADMIN:"Admin"}[a=s.role]||a,disabled:!0})})]}),(0,b.jsxs)(m.Field,{children:[(0,b.jsx)(m.FieldLabel,{htmlFor:"phone_number",children:"Phone Number"}),(0,b.jsxs)(m.FieldContent,{children:[(0,b.jsx)(k.Input,{id:"phone_number",type:"tel",value:G,onChange:a=>H(a.target.value),disabled:!y,placeholder:"Enter your phone number"}),(0,b.jsx)(m.FieldDescription,{children:"Optional: Add your phone number for event notifications"})]})]}),(0,b.jsxs)(m.Field,{children:[(0,b.jsx)(m.FieldLabel,{htmlFor:"bio",children:"Bio"}),(0,b.jsxs)(m.FieldContent,{children:[(0,b.jsx)("textarea",{id:"bio",value:I,onChange:a=>J(a.target.value),disabled:!y,placeholder:"Tell us about yourself...",rows:4,className:"flex min-h-[80px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm"}),(0,b.jsx)(m.FieldDescription,{children:"Optional: Write a short bio about yourself"})]})]}),C&&(0,b.jsx)(m.Field,{children:(0,b.jsx)(m.FieldError,{children:C})})]})}),(0,b.jsx)(l.CardFooter,{className:"flex gap-2",children:y?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(j.Button,{onClick:aa,disabled:A,children:A?"Saving...":"Save Changes"}),(0,b.jsx)(j.Button,{variant:"outline",onClick:()=>{z(!1),D(null),s&&(H(s.phone_number||""),J(s.bio||""))},children:"Cancel"})]}):(0,b.jsx)(j.Button,{onClick:()=>{z(!0),D(null)},children:"Edit Profile"})})]}),"followed"===E&&(0,b.jsxs)(l.Card,{children:[(0,b.jsxs)(l.CardHeader,{children:[(0,b.jsx)(l.CardTitle,{children:"Followed Organizations"}),(0,b.jsx)(l.CardDescription,{children:"Organizations you are following to track their events"})]}),(0,b.jsx)(l.CardContent,{children:M?(0,b.jsx)("p",{className:"text-muted-foreground",children:"Loading organizations..."}):O?(0,b.jsxs)("div",{className:"text-red-600",children:[(0,b.jsxs)("p",{children:["Error: ",O]}),(0,b.jsx)(j.Button,{variant:"outline",className:"mt-4",onClick:()=>{P(null),F("followed")},children:"Retry"})]}):0===K.length?(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)("p",{className:"text-muted-foreground mb-4",children:"You are not following any organizations yet."}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:'Visit an organization page and click "Follow Organization" to start tracking their events.'})]}):(0,b.jsx)("div",{className:"space-y-4",children:K.map(a=>(0,b.jsx)(l.Card,{className:"border",children:(0,b.jsx)(l.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)(e.default,{href:`/organizations/detail?id=${a.id}`,className:"text-lg font-semibold text-blue-600 hover:text-blue-800 hover:underline",onClick:()=>{sessionStorage.setItem("org_detail_referrer","/profile")},children:a.name}),a.description&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground mt-2 line-clamp-2",children:a.description}),(0,b.jsxs)("div",{className:"flex items-center gap-4 mt-3 text-sm text-muted-foreground",children:[a.event_count>0&&(0,b.jsxs)("span",{children:[a.event_count," active event",1!==a.event_count?"s":""]}),a.city&&a.country&&(0,b.jsxs)("span",{children:["ðŸ“ ",a.city,", ",a.country]})]})]}),(0,b.jsx)(j.Button,{variant:"outline",size:"sm",onClick:()=>$(a.id),disabled:Q.has(a.id),className:"flex-shrink-0",children:Q.has(a.id)?"Unfollowing...":"Unfollow"})]})})},a.id))})})]}),"interested"===E&&s?.role==="ATTENDEE"&&(0,b.jsxs)(l.Card,{children:[(0,b.jsxs)(l.CardHeader,{children:[(0,b.jsx)(l.CardTitle,{children:"Interested Events"}),(0,b.jsx)(l.CardDescription,{children:"Events you've marked as interested"})]}),(0,b.jsx)(l.CardContent,{children:U?(0,b.jsx)("div",{className:"text-center py-8",children:(0,b.jsx)("p",{className:"text-muted-foreground",children:"Loading events..."})}):W?(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)("p",{className:"text-red-500",children:W}),(0,b.jsx)(j.Button,{variant:"outline",className:"mt-4",onClick:()=>{X(null),"interested"===E&&(async()=>{try{V(!0);let a=await (0,i.getInterestedEvents)();T(a)}catch(a){X(a instanceof Error?a.message:"Failed to load interested events")}finally{V(!1)}})()},children:"Retry"})]}):0===S.length?(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)("p",{className:"text-muted-foreground mb-4",children:"You haven't marked any events as interested yet."}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:'Visit an event and click "Interested" to start tracking events you\'re considering.'})]}):(0,b.jsx)("div",{className:"space-y-4",children:S.map(a=>(0,b.jsx)(l.Card,{className:"border",children:(0,b.jsx)(l.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)(e.default,{href:`/events/${a.id}`,className:"text-lg font-semibold text-blue-600 hover:text-blue-800 hover:underline",children:a.name}),a.description&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground mt-2 line-clamp-2",children:a.description}),(0,b.jsxs)("div",{className:"flex items-center gap-4 mt-3 text-sm text-muted-foreground",children:[(0,b.jsxs)("span",{children:["ðŸ“… ",new Date(a.date).toLocaleString()]}),a.location&&(0,b.jsxs)("span",{children:["ðŸ“ ",a.location]}),void 0!==a.participant_count&&(0,b.jsxs)("span",{children:["ðŸ‘¥ ",a.participant_count," participant",1!==a.participant_count?"s":""]}),void 0!==a.interest_count&&a.interest_count>0&&(0,b.jsxs)("span",{children:["â¤ï¸ ",a.interest_count," interested"]})]})]}),(0,b.jsx)(j.Button,{variant:"outline",size:"sm",onClick:()=>_(a.id),disabled:Y.has(a.id),className:"flex-shrink-0",children:Y.has(a.id)?"Removing...":"Remove Interest"})]})})},a.id))})})]}),s.participating_events.length>0&&(0,b.jsxs)(l.Card,{className:"mt-6",children:[(0,b.jsxs)(l.CardHeader,{children:[(0,b.jsx)(l.CardTitle,{children:"Participating Events"}),(0,b.jsxs)(l.CardDescription,{children:["You are registered for ",s.participating_events.length," event",1!==s.participating_events.length?"s":""]})]}),(0,b.jsx)(l.CardContent,{children:(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Event IDs: ",s.participating_events.join(", ")]})})]})]}):(0,b.jsx)("div",{className:"p-6",children:(0,b.jsx)("p",{children:"No profile data available"})}):(0,b.jsx)("div",{className:"container mx-auto p-8 max-w-4xl",children:(0,b.jsx)("p",{children:"Loading..."})})}a.s(["default",()=>n])}];

//# sourceMappingURL=app_profile_page_tsx_d7e3fb30._.js.map