(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,70065,13626,e=>{"use strict";var t=e.i(43476),a=e.i(47163);function s({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card",className:(0,a.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...s})}function r({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card-content",className:(0,a.cn)("px-6",e),...s})}function i({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card-footer",className:(0,a.cn)("flex items-center px-6 [.border-t]:pt-6",e),...s})}e.s(["Card",()=>s,"CardContent",()=>r,"CardFooter",()=>i],70065),e.i(47167);var l=e.i(71645),n=e.i(22016),c=e.i(38036),o=e.i(67881);let d="https://APimenta4.pythonanywhere.com/api";async function h(e){return(0,c.fetchWithAuth)(`${d}/events/${e}/cancel/`,{method:"POST"})}async function x(e){return(0,c.fetchWithAuth)(`${d}/events/${e}/uncancel/`,{method:"POST"})}function u({id:e,onClose:a}){let[s,r]=(0,l.useState)(null),[i,d]=(0,l.useState)(!0),[u,m]=(0,l.useState)(null),[p,g]=(0,l.useState)(!1),[f,y]=(0,l.useState)(null),[v,b]=(0,l.useState)(()=>{try{let e=localStorage.getItem("auth_tokens");if(!e)return!1;return!!JSON.parse(e).access}catch{return!1}});(0,l.useEffect)(()=>{if(!e)return;let t=!1,s="https://APimenta4.pythonanywhere.com/api";(async()=>{try{let a;if(v)try{a=await (0,c.fetchWithAuth)(`${s}/events/${e}/`),(401===a.status||403===a.status)&&(localStorage.removeItem("auth_tokens"),b(!1),a=await fetch(`${s}/events/${e}/`))}catch{localStorage.removeItem("auth_tokens"),b(!1),a=await fetch(`${s}/events/${e}/`)}else a=await fetch(`${s}/events/${e}/`);if(!a.ok)throw Error(`Status ${a.status}`);let i=await a.json();t||r(i)}catch(e){t||m(e instanceof Error?e.message:"Failed to load event")}finally{t||d(!1)}})();let i=e=>{"Escape"===e.key&&a()};return window.addEventListener("keydown",i),()=>{t=!0,window.removeEventListener("keydown",i)}},[e,a,v]),(0,l.useEffect)(()=>{v&&(0,c.fetchWithAuth)("https://APimenta4.pythonanywhere.com/api/auth/users/me/").then(e=>{if(!e.ok)throw(401===e.status||403===e.status)&&(localStorage.removeItem("auth_tokens"),b(!1)),Error(`Status ${e.status}`);return e.json()}).then(e=>{y(e)}).catch(()=>{})},[v]);let j=async()=>{if(!s)return;let e=s.is_participating?"DELETE":"POST";try{let t=await (0,c.fetchWithAuth)(`https://APimenta4.pythonanywhere.com/api/events/${s.id}/participate/`,{method:e}),a=await t.json();t.ok&&r(e=>e?{...e,participant_count:a.participant_count,is_participating:a.is_participating,is_full:a.is_full}:e)}catch{}};if(!e)return null;let w=async()=>{if(s&&window.confirm("Are you sure you want to cancel this event?"))try{let e=await h(s.id);if(!e.ok)throw Error("Failed to cancel event");let t=await e.json();r(t)}catch{alert("Could not cancel event")}},N=async()=>{if(s&&window.confirm("Do you want to reactivate this event?"))try{let e=await x(s.id);if(!e.ok)throw Error("Failed to reactivate the event");let t=await e.json();r(t)}catch{alert("Could not reactivate the event")}};return(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60",role:"dialog","aria-modal":"true",onClick:a,children:(0,t.jsxs)("div",{className:"bg-white rounded-3xl max-w-2xl w-full mx-4 p-10 relative shadow-2xl max-h-[90vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[(0,t.jsx)("button",{"aria-label":"Close modal",onClick:a,className:"absolute top-8 right-8 text-gray-400 hover:text-gray-600 text-3xl leading-none",children:"Ã—"}),(0,t.jsxs)("div",{className:"pr-8",children:[i&&(0,t.jsx)("p",{className:"text-lg",children:"Loading..."}),u&&(0,t.jsxs)("p",{className:"text-red-600 text-lg",children:["Error: ",u]}),!i&&!u&&s&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h2",{className:`text-3xl font-bold ${s.status?"mb-2":"mb-8"}`,children:s.name}),s.status&&(0,t.jsx)("div",{className:"mb-8",children:(0,t.jsx)("span",{className:`px-3 py-1 text-sm font-semibold text-white rounded-full ${"Active"===s.status?"bg-green-500":"bg-red-500"}`,children:s.status})}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs font-bold uppercase tracking-wider text-gray-700 mb-2",children:"Date"}),(0,t.jsx)("div",{className:"text-base text-gray-800",children:s.date?new Date(s.date).toLocaleString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A"})]}),s.location&&(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs font-bold uppercase tracking-wider text-gray-700 mb-2",children:"Location"}),(0,t.jsx)("div",{className:"text-base text-gray-800",children:s.location})]}),s.organizer_name&&(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs font-bold uppercase tracking-wider text-gray-700 mb-2",children:"Organizer"}),(0,t.jsx)("div",{className:"text-base text-gray-800",children:s.organizer_name})]}),s.description&&(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs font-bold uppercase tracking-wider text-gray-700 mb-2",children:"Description"}),(0,t.jsx)("div",{className:"text-base text-gray-800 leading-relaxed whitespace-pre-wrap",children:s.description})]})]}),f?.role==="ORGANIZER"&&f.id===s.organizer&&(0,t.jsxs)("div",{className:"border-t border-gray-200 mt-6 pt-6",children:[(0,t.jsxs)("button",{onClick:()=>g(!p),className:"w-full flex justify-between items-center text-left text-lg font-semibold text-gray-800 hover:text-gray-900","aria-expanded":p,children:[(0,t.jsx)("span",{children:"Participants"}),(0,t.jsx)("span",{className:`transform transition-transform duration-200 ${p?"rotate-180":""}`,children:"â–¼"})]}),p&&(0,t.jsx)("div",{className:"mt-4 text-gray-700",children:"Participant list goes here..."})]}),v?(0,t.jsxs)(t.Fragment,{children:[f?.role==="ATTENDEE"&&"Canceled"!==s.status&&(0,t.jsxs)("div",{className:"mt-8 pt-6 border-t border-gray-200 flex flex-col gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,t.jsxs)("span",{className:"text-gray-600",children:["Participants: ",s?.participant_count,s?.capacity!==null&&s?.capacity!==void 0&&s?.capacity>0&&(0,t.jsxs)("span",{children:["/",s.capacity]}),(s?.capacity===null||s?.capacity===0)&&(0,t.jsx)("span",{children:" (Unlimited)"})]}),s?.is_full&&(0,t.jsx)("span",{className:"px-2 py-1 text-xs font-semibold text-white bg-red-500 rounded-full",children:"Event Full"})]}),(0,t.jsxs)("div",{className:"flex gap-4",children:[(0,t.jsx)(o.Button,{onClick:j,disabled:s?.is_full&&!s?.is_participating,className:"flex-1 font-bold py-4 rounded-xl "+(s?.is_participating?"bg-red-600 hover:bg-red-500 text-white":s?.is_full?"bg-gray-400 cursor-not-allowed text-white":"bg-gray-800 hover:bg-gray-600 text-white"),children:s?.is_participating?"Cancel Participation":s?.is_full?"Event Full":"Participate"}),(0,t.jsx)(o.Button,{className:"flex-1 bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-4 rounded-xl",children:"Interested"})]})]}),f?.role==="ORGANIZER"&&f.id===s.organizer&&(0,t.jsxs)("div",{className:"mt-8 pt-6 border-t border-gray-200 flex gap-4",children:[(0,t.jsx)(n.default,{href:`/events/edit/${s.id}`,className:"flex-1",children:(0,t.jsx)(o.Button,{className:"w-full bg-gray-800 hover:bg-gray-500 text-white font-bold py-4 rounded-xl",children:"Edit"})}),"Canceled"===s.status?(0,t.jsx)(o.Button,{onClick:N,className:"flex-1 w-full bg-green-500 hover:bg-green-600 text-white font-bold py-4 rounded-xl",children:"Reactivate Event"}):(0,t.jsx)(o.Button,{onClick:w,className:"flex-1 w-full bg-red-500 hover:bg-red-600 text-white font-bold py-4 rounded-xl",children:"Cancel Event"})]})]}):(0,t.jsx)("div",{className:"mt-8 pt-6 border-t border-gray-200 flex gap-4",children:(0,t.jsx)(n.default,{href:"/profile/login",className:"flex-1",children:(0,t.jsx)(o.Button,{className:"w-full bg-gray-800 hover:bg-gray-900 text-white font-bold py-4 rounded-xl",children:"Login"})})})]})]})]})})}e.s(["default",()=>u],13626)},31713,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(70065),r=e.i(67881),i=e.i(13626);function l(){let[e,l]=(0,a.useState)([]),[n,c]=(0,a.useState)(!0),[o,d]=(0,a.useState)(null),[h,x]=(0,a.useState)(!1),[u,m]=(0,a.useState)(null),p="https://APimenta4.pythonanywhere.com/api";return((0,a.useEffect)(()=>{(async()=>{try{let e=await fetch(`${p}/events/upcoming/`);if(!e.ok)throw Error("Failed to fetch events");let t=await e.json(),a=Array.isArray(t)?t:t.results;l(a??[])}catch{d("Could not load events")}finally{c(!1)}})()},[p]),n)?(0,t.jsx)("p",{children:"Loading events..."}):o?(0,t.jsxs)("p",{children:["Error: ",o]}):e.length?(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-3xl font-bold mb-6",children:"Upcoming Events"}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:e.map(e=>(0,t.jsxs)(s.Card,{className:"shadow transition relative hover:shadow-lg",children:["Canceled"===e.status&&(0,t.jsx)("span",{className:"absolute top-2 right-2 bg-red-500 text-white text-xs px-2 py-1 rounded-md",children:"Canceled"}),(0,t.jsxs)(s.CardContent,{children:[(0,t.jsx)("h3",{className:"text-xl font-semibold",children:e.name}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:new Date(e.date).toLocaleString()}),e.location&&(0,t.jsxs)("p",{className:"text-sm text-gray-700 mt-1",children:["ðŸ“ ",e.location]})]}),(0,t.jsx)(s.CardFooter,{children:(0,t.jsx)(r.Button,{variant:"outline",onClick:()=>{m(String(e.id)),x(!0)},children:"View Details"})})]},e.id))}),h&&u&&(0,t.jsx)(i.default,{id:u,onClose:()=>{x(!1),m(null)}})]}):(0,t.jsx)("p",{children:"No events available"})}e.s(["default",()=>l])}]);